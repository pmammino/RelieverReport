slugging <- transform(slugging, MarJun_BB. = as.numeric(sub("%", "", MarJun_BB.)))
slugging <- transform(slugging, MarJun_K. = as.numeric(sub("%", "",MarJun_K.)))
slugging <- transform(slugging, MarJun_LD. = as.numeric(sub("%", "",MarJun_LD.)))
slugging <- transform(slugging, MarJun_GB. = as.numeric(sub("%", "",MarJun_GB.)))
slugging <- transform(slugging, MarJun_FB. = as.numeric(sub("%", "",MarJun_FB.)))
slugging <- transform(slugging, MarJun_HR.FB = as.numeric(sub("%", "",MarJun_HR.FB)))
slugging <- transform(slugging, MarJun_Hard = as.numeric(sub("%", "",MarJun_Hard)))
slugging$slugging_diff <- slugging$FullSeason_SLG - slugging$MarJun_SLG
# Develop Test and Train Data Sets and Run Model On Train Score with Test #
set.seed(30)
train_ind <- sample(seq_len(nrow(slugging)), size = 30)
Test <- slugging[train_ind,]
Train <-slugging[-train_ind,]
slugging_diff_model_Train <- lm(slugging_diff ~ MarJun_K. + MarJun_HR.FB + MarJun_BABIP + MarJun_GB.FB, data = Train)
Test$predicted_diff <- predict(slugging_diff_model, newdata = Test)
Test$xSLG <- Test$MarJun_SLG + Test$predicted_diff
cor(Test$xSLG, Test$FullSeason_SLG)
#Run Full Model On All Data Points
slugging_diff_model <- lm(slugging_diff ~ slugging$MarJun_K. + slugging$MarJun_HR.FB + slugging$MarJun_BABIP + slugging$MarJun_GB.FB, data = slugging)
slugging$predicted_diff <- predict(slugging_diff_model)
slugging$xSLG2 <- slugging$MarJun_SLG + slugging$predicted_diff
## Import and Clean Data Removing the % and Making Sure all Variables were read in appropriate format ##
slugging <- read.csv("slugging.csv")
slugging <- transform(slugging, MarJun_BB. = as.numeric(sub("%", "", MarJun_BB.)))
slugging <- transform(slugging, MarJun_K. = as.numeric(sub("%", "",MarJun_K.)))
slugging <- transform(slugging, MarJun_LD. = as.numeric(sub("%", "",MarJun_LD.)))
slugging <- transform(slugging, MarJun_GB. = as.numeric(sub("%", "",MarJun_GB.)))
slugging <- transform(slugging, MarJun_FB. = as.numeric(sub("%", "",MarJun_FB.)))
slugging <- transform(slugging, MarJun_HR.FB = as.numeric(sub("%", "",MarJun_HR.FB)))
slugging <- transform(slugging, MarJun_Hard = as.numeric(sub("%", "",MarJun_Hard)))
slugging$slugging_diff <- slugging$FullSeason_SLG - slugging$MarJun_SLG
# Develop Test and Train Data Sets and Run Model On Train Score with Test #
set.seed(30)
train_ind <- sample(seq_len(nrow(slugging)), size = 30)
Test <- slugging[train_ind,]
Train <-slugging[-train_ind,]
slugging_diff_model_Train <- lm(slugging_diff ~ MarJun_K. + MarJun_HR.FB + MarJun_BABIP + MarJun_GB.FB, data = Train)
Test$predicted_diff <- predict(slugging_diff_model_Train, newdata = Test)
Test$xSLG <- Test$MarJun_SLG + Test$predicted_diff
cor(Test$xSLG, Test$FullSeason_SLG)
#Run Full Model On All Data Points
slugging_diff_model <- lm(slugging_diff ~ slugging$MarJun_K. + slugging$MarJun_HR.FB + slugging$MarJun_BABIP + slugging$MarJun_GB.FB, data = slugging)
slugging$predicted_diff <- predict(slugging_diff_model)
slugging$xSLG2 <- slugging$MarJun_SLG + slugging$predicted_diff
## Import and Clean Data Removing the % and Making Sure all Variables were read in appropriate format ##
slugging <- read.csv("slugging.csv")
slugging <- transform(slugging, MarJun_BB. = as.numeric(sub("%", "", MarJun_BB.)))
slugging <- transform(slugging, MarJun_K. = as.numeric(sub("%", "",MarJun_K.)))
slugging <- transform(slugging, MarJun_LD. = as.numeric(sub("%", "",MarJun_LD.)))
slugging <- transform(slugging, MarJun_GB. = as.numeric(sub("%", "",MarJun_GB.)))
slugging <- transform(slugging, MarJun_FB. = as.numeric(sub("%", "",MarJun_FB.)))
slugging <- transform(slugging, MarJun_HR.FB = as.numeric(sub("%", "",MarJun_HR.FB)))
slugging <- transform(slugging, MarJun_Hard = as.numeric(sub("%", "",MarJun_Hard)))
slugging$slugging_diff <- slugging$FullSeason_SLG - slugging$MarJun_SLG
corr <- cor(slugging[,-1])
corr <- cor(slugging[,-c(1,2)])
slugging_diff_model <- lm(slugging_diff ~ slugging$MarJun_K. + slugging$MarJun_HR.FB + slugging$MarJun_BABIP + slugging$MarJun_GB.FB + slugging$PF_HR + slugging$PF_2B + slugging$PF_3B, data = slugging)
summary(slugging_diff_model)
PCaPF <- prcomp(slugging[c(18,19,20)])
slugging <- crbind(slugging, predict(PCaPF))
slugging <- cbind(slugging, predict(PCaPF))
corr <- cor(slugging[,-c(1,2)])
library(cluster)
## Import and Clean Data Removing the % and Making Sure all Variables were read in appropriate format ##
slugging <- read.csv("slugging.csv")
slugging <- transform(slugging, MarJun_BB. = as.numeric(sub("%", "", MarJun_BB.)))
slugging <- transform(slugging, MarJun_K. = as.numeric(sub("%", "",MarJun_K.)))
slugging <- transform(slugging, MarJun_LD. = as.numeric(sub("%", "",MarJun_LD.)))
slugging <- transform(slugging, MarJun_GB. = as.numeric(sub("%", "",MarJun_GB.)))
slugging <- transform(slugging, MarJun_FB. = as.numeric(sub("%", "",MarJun_FB.)))
slugging <- transform(slugging, MarJun_HR.FB = as.numeric(sub("%", "",MarJun_HR.FB)))
slugging <- transform(slugging, MarJun_Hard = as.numeric(sub("%", "",MarJun_Hard)))
slugging$slugging_diff <- slugging$FullSeason_SLG - slugging$MarJun_SLG
PCAPF <- prcomp(slugging[c(18,19,20)])
slugging <- cbind(slugging, predict(PCAPF))
corr <- cor(slugging[,-c(1,2)])
# Develop Test and Train Data Sets and Run Model On Train Score with Test #
set.seed(30)
train_ind <- sample(seq_len(nrow(slugging)), size = 30)
Test <- slugging[train_ind,]
Train <-slugging[-train_ind,]
slugging_diff_model_Train <- lm(slugging_diff ~ MarJun_K. + MarJun_HR.FB + MarJun_BABIP + MarJun_GB.FB, data = Train)
Test$predicted_diff <- predict(slugging_diff_model_Train, newdata = Test)
Test$xSLG <- Test$MarJun_SLG + Test$predicted_diff
cor(Test$xSLG, Test$FullSeason_SLG)
#Run Full Model On All Data Points
slugging_diff_model <- lm(slugging_diff ~ slugging$MarJun_K. + slugging$MarJun_HR.FB + slugging$MarJun_BABIP + slugging$MarJun_GB.FB, data = slugging)
slugging$predicted_diff <- predict(slugging_diff_model)
slugging$xSLG <- slugging$MarJun_SLG + slugging$predicted_diff
url <- "https://www.teamrankings.com/nfl/team/new-england-patriots"
patriots <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
patriots <- patriots[[1]]
library(rvest)
library(plyr)
url <- "https://www.teamrankings.com/nfl/team/new-england-patriots"
patriots <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
patriots <- patriots[[1]]
View(patriots)
patriots2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
patriots2 <- patriots2[[1]]
patriots3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
patriots3 <- patriots3[[1]]
View(patriots2)
View(patriots3)
patriots2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
patriots2 <- patriots2[[1]]
View(patriots2)
ppplaypats <- ["Patriots", patriots2[2,2]]
ppplaypats <- c("Patriots", patriots2[2,2])
url <- "https://www.teamrankings.com/nfl/"+"team/new-england-patriots"
patriots1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
patriots1 <- patriots1[[1]]
url <- paste("https://www.teamrankings.com/nfl/","team/new-england-patriots", sep = '')
patriots1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
patriots1 <- patriots1[[1]]
View(patriots1)
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
library(rvest)
library(plyr)
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
library(rvest)
library(plyr)
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
library(rvest)
library(plyr)
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(pointsperplay,team, table2[2,2])
}
points_per_play("new-england-patriots")
pointsperplay <- c()
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(pointsperplay,team, table2[2,2])
}
points_per_play("new-england-patriots")
View(points_per_play)
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team , sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
points_per_play("new-england-patriots")
points_per_play("new-england-patriots")
points_per_play <- function()
{
url <- "https://www.teamrankings.com/nfl/team/new-england-patriots"
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c(team, table2[2,2])
}
points_per_play()
points_per_play <- function()
{
url <- "https://www.teamrankings.com/nfl/team/new-england-patriots"
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c("new-england-patriots", table2[2,2])
}
points_per_play()
points_per_play <- function()
{
url <- "https://www.teamrankings.com/nfl/team/new-england-patriots"
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplay <- c("new-england-patriots", table2[2,2])
return(pointsperplay)
}
points_per_play()
pointsperplaylist <- c()
points_per_play <- function()
{
url <- paste("https://www.teamrankings.com/nfl/team/", team, sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplaylist <- c(pointsperplaylist,team, table2[2,2])
return(pointsperplaylist)
}
Pointsperplay <- points_per_play("new-england-patriots")
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team, sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplaylist <- c(pointsperplaylist,team, table2[2,2])
return(pointsperplaylist)
}
Pointsperplay <- points_per_play("new-england-patriots")
points_per_play <- function(team)
{
url <- paste("https://www.teamrankings.com/nfl/team/", team, sep = '')
table1 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[1]') %>%
html_table()
table1 <- table1[[1]]
table2 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[2]') %>%
html_table()
table2 <- table2[[1]]
table3 <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="html"]/body/div[3]/div[1]/div[2]/aside/table[3]') %>%
html_table()
table3 <- table3[[1]]
pointsperplaylist <- c(team, table2[2,2])
return(pointsperplaylist)
}
Pointsperplay <- c()
Pointsperplay <- c(Pointsperplay, points_per_play("new-england-patriots"))
teamlist <- c("philadelphia-eagles", "new-england-patriots" )
Pointsperplay <- lapply(teamlist,points_per_play)
Pointsperplay
Pointsperplay <- rbindlist(lapply(teamlist,points_per_play), fill = TRUE)
library(data.table)
Pointsperplay <- rbindlist(lapply(teamlist,points_per_play), fill = TRUE)
ppp <- lapply(teamlist,points_per_play)
Pointsperplay <- rbindlist(ppp, fill = TRUE)
Pointsperplay <- do.call(rbind, ppp) %>% as.data.frame
View(Pointsperplay)
library(rvest)
library(plyr)
url <- paste("http://degeneratebaseballle1457212551.baseball.cbssports.com/stats/stats-main/fa:C/restofseason:p/standard/projections?print_rows=9999", team, sep = '')
Catchers <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="sortableStats"]/table') %>%
html_table()
Catchers <- Catchers[[1]]
library(rvest)
library(plyr)
url <- paste("http://degeneratebaseballle1457212551.baseball.cbssports.com/stats/stats-main/fa:C/restofseason:p/standard/projections?print_rows=9999"
Catchers <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="sortableStats"]/table') %>%
html_table()
Catchers <- Catchers[[1]]
library(rvest)
library(plyr)
url <- "http://degeneratebaseballle1457212551.baseball.cbssports.com/stats/stats-main/fa:C/restofseason:p/standard/projections?print_rows=9999"
Catchers <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="sortableStats"]/table') %>%
html_table()
Catchers <- Catchers[[1]]
Catchers <- url %>%
read_html() %>%
html_nodes(xpath= '//*[@id="sortableStats"]/table') %>%
html_table()
rsconnect::deployApp()
library("rsconnect", lib.loc="~/R/win-library/3.4")
rsconnect::deployApp()
rsconnect::deployApp()
shiny::runApp('RelieverReport')
rsconnect::deployApp()
options(rsconnect.max.bundle.size=3145728000)
rsconnect::deployApp()
source("data/RelieverData.R")
setwd("~/RelieverReport")
rsconnect::deployApp()
rsconnect::deployApp()
rsconnect::deployApp()
rsconnect::deployApp()
